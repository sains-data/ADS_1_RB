---
title: "TUGAS BESAR ADS - Analisis Statistik Deskriptif IPK, Jam Belajar, dan Karakteristik
  Mahasiswa ITERA"
author: "KELOMPOK 1"
date: "2025-11-18"
output:
  pdf_document: default
  html_document: default
---

# 1. Persiapan Lingkungan (Environment Setup)

Pada tahap ini, saya akan memuat semua library yang dibutuhkan dan mendefinisikan fungsi-fungsi statistik agar lebih mudah

```{r}

# ===============================MEMUAT LIBRARY=================================

library(ggplot2)
library(dplyr)
library(readr)

# ===============================DEFINISI FUNGSI================================

# 1. Menghitung Skewness
skew_manual <- function(x) {
  x <- x[!is.na(x)]
  m <- mean(x)
  s <- sd(x)
  mean(((x - m) / s)^3)
}

# 2. Interpretasi
interpret_skewness <- function(value) {
  if (is.na(value)) return("Data tidak cukup untuk menghitung skewness.")
  
  if (value > 1) {
    return("Distribusi sangat condong ke kanan (right-skewed kuat).")
  } else if (value > 0.5) {
    return("Distribusi condong ke kanan dengan tingkat moderat.")
  } else if (value > 0) {
    return("Distribusi sedikit condong ke kanan.")
  } else if (value == 0) {
    return("Distribusi simetris.")
  } else if (value > -0.5) {
    return("Distribusi sedikit condong ke kiri.")
  } else if (value > -1) {
    return("Distribusi condong ke kiri dengan tingkat moderat.")
  } else {
    return("Distribusi sangat condong ke kiri (left-skewed kuat).")
  }
}
```




# 2. Data Loading & Preprocessing

membaca dataset dan melakukan pembersihan data (Data Cleansing) sekaligus untuk semua kolom yang bermasalah. Ini memastikan data siap digunakan untuk visualisasi apa pun.
```{r}
# Load Data
data <- read.csv("Dataset/dataset.csv")

# --- DATA CLEANSING ---

# A. Pembersihan Kolom IPK Terakhir
# Mengganti karakter non-numerik dengan NA, memperbaiki desimal, dan filter range logis (0-4)
data$IPK.Terakhir..[data$IPK.Terakhir.. %in% c("-", ".", ",", "", " ")] <- NA
data$IPK.Terakhir.. <- gsub(",", ".", data$IPK.Terakhir..)
data$IPK.Terakhir.. <- as.numeric(data$IPK.Terakhir..)
data$IPK.Terakhir..[data$IPK.Terakhir.. > 4 | data$IPK.Terakhir.. == 0] <- NA

# B. Pembersihan Kolom Jam Belajar
# Rename kolom, perbaikan desimal, dan filter range logis (0-60 jam/minggu)
names(data)[names(data) == "Rata.rata.belajar.perminggu..dalam.jam..."] <- "BelajarJam"
data$BelajarJam <- gsub(",", ".", data$BelajarJam)
data$BelajarJam <- as.numeric(data$BelajarJam)
data$BelajarJam[data$BelajarJam < 0 | data$BelajarJam > 60] <- NA

# C. Pembersihan Kolom Anggota Keluarga
# Mengambil hanya angka, mengubah ke integer, batas wajar max 12
data$Jumlah.Anggota.Keluarga.. <- as.character(data$Jumlah.Anggota.Keluarga..)
data$Jumlah.Anggota.Keluarga.. <- gsub("[^0-9]", "", data$Jumlah.Anggota.Keluarga..)
data$Jumlah.Anggota.Keluarga..[data$Jumlah.Anggota.Keluarga.. == ""] <- NA
data$Jumlah.Anggota.Keluarga.. <- as.integer(data$Jumlah.Anggota.Keluarga..)
data$Jumlah.Anggota.Keluarga..[data$Jumlah.Anggota.Keluarga.. > 12] <- NA

# D. Pembersihan Kolom Berat Badan
# Hapus "kg", spasi, ambil angka
data$Berat.Badan.. <- as.character(data$Berat.Badan..)
data$Berat.Badan.. <- gsub("kg", "", data$Berat.Badan.., ignore.case = TRUE)
data$Berat.Badan.. <- gsub("[^0-9.]", "", data$Berat.Badan..)
data$Berat.Badan.. <- as.numeric(data$Berat.Badan..)

# E. Pembersihan Kolom Tinggi Badan
# Hapus "cm", filter range logis (120-220 cm)
data$Tinggi.Badan.. <- as.character(data$Tinggi.Badan..)
data$Tinggi.Badan.. <- gsub("cm", "", data$Tinggi.Badan.., ignore.case = TRUE)
data$Tinggi.Badan.. <- gsub("[^0-9.]", "", data$Tinggi.Badan..)
data$Tinggi.Badan.. <- as.numeric(data$Tinggi.Badan..)
data$Tinggi.Badan..[data$Tinggi.Badan.. < 120 | data$Tinggi.Badan.. > 220] <- NA

# Menampilkan Ringkasan Data Bersih
summary(data)
```




# 3. Analisis Variabel Akademik

    A. Sebaran IPK Terakhir
visualisasi sebaran IPK mahasiswa menggunakan Dot Plot,
stem-leaf, dan analisis Outlier menggunakan metode IQR.
```{r}
# 1. Dot Plot
ggplot(data, aes(x = `IPK.Terakhir..`)) +
  geom_dotplot(binwidth = 0.045, fill = "lightgreen", color = "darkgreen") +
  labs(
    title = "Dot plot Sebaran IPK Terakhir Mahasiswa",
    x = "IPK",
    y = "Kerapatan"
  ) +
  theme_minimal()

# 2. Stem and Leaf Plot
cat("Stem and Leaf Plot IPK:\n")
stem(data$`IPK.Terakhir..`, scale = 2)


# 3. Deteksi Outlier (Metode IQR)
cat("==========================================================================")
cat("\n")

Q1 <- quantile(data$`IPK.Terakhir..`, 0.25, na.rm = TRUE)
Q3 <- quantile(data$`IPK.Terakhir..`, 0.75, na.rm = TRUE)
IQR_value <- Q3 - Q1


batas_bawah <- Q1 - (1.5 * IQR_value)
batas_atas  <- Q3 + (1.5 * IQR_value)

cat("\n--- HASIL PERHITUNGAN IQR ---\n")
cat("Kuartil 1 (25%) :", Q1, "\n")
cat("Kuartil 3 (75%) :", Q3, "\n")
cat("Nilai IQR       :", IQR_value, "\n")
cat("Batas Bawah     :", batas_bawah, "\n")
cat("Batas Atas      :", batas_atas, "\n")
cat("-----------------------------\n")


data_outlier <- data[which(data$`IPK.Terakhir..` < batas_bawah | 
                           data$`IPK.Terakhir..` > batas_atas), ]

if(nrow(data_outlier) > 0) {
  cat("DITEMUKAN", nrow(data_outlier), "DATA OUTLIER:\n")
  print(data_outlier[, c("IPK.Terakhir..")])
} else {
  cat("Data bersih. Tidak ditemukan outlier dengan metode IQR.\n")
  
}

cat("==========================================================================\n")
cat("Ringkasan\n")

summary(data$`IPK.Terakhir..`)
```


    B. Distribusi Jam Belajar
jam belajar mahasiswa per minggu.
```{r}
# 1. Histogram 
names(data)[names(data) == "Rata.rata.belajar.perminggu..dalam.jam..."] <- "BelajarJam"
hist_plot <- ggplot(data, aes(x = BelajarJam)) +
  geom_histogram(
    binwidth = 5, # Anda bisa menyesuaikan lebar bin
    fill = "lightgreen",
    color = "darkgreen",
    alpha = 0.7
  ) +
  geom_density(aes(y = after_stat(count) * 5), color = "darkred", linewidth = 1) + 
  labs(
    title = "Histogram Distribusi Jam Belajar per Minggu",
    x = "Jam Belajar per Minggu",
    y = "Frekuensi"
  ) +
  theme_minimal()

print(hist_plot)

# 2. Boxplot
ggplot(data, aes(y = BelajarJam)) +
  geom_boxplot(fill = "lightgreen", color = "darkgreen") +
  labs(
    title = "Boxplot Jam Belajar per Minggu",
    y = "Jam Belajar per Minggu"
  ) +
  theme_minimal()

cat("Ringkasan\n")

summary(data$BelajarJam)

```



# 4. Analisis Variabel Demografis & Fisik

    A. Jumlah Anggota Keluarga
```{r}
ggplot(data, aes(x = factor(Jumlah.Anggota.Keluarga..))) +
  geom_bar(fill = "lightgreen") +
  scale_y_continuous(
    breaks = seq(0, max(table(data$Jumlah.Anggota.Keluarga..)), by = 10)
  ) +
  labs(
    title = "Distribusi Jumlah Anggota Keluarga",
    x = "Jumlah Anggota Keluarga",
    y = "Jumlah Mahasiswa"
  ) +
  theme_minimal()



summary(data$`Jumlah.Anggota.Keluarga..`)

```



# B. Analisis Fisik (Berat & Tinggi Badan)
melihat kecendrungan (skewness) dari data fisik mahasiswa.
```{r}
# --- BERAT BADAN ---

cat("Ringkasan berat badan:\n")
summary(data$Berat.Badan..)
cat("\n\nRingkasan tinggi badan:\n")
summary(data$Tinggi.Badan..)

skew_berat <- skew_manual(data$Berat.Badan..)
cat("\n==========================================================================\n")


cat("--- ANALISIS BERAT BADAN ---\n")
cat("Nilai Skewness :", round(skew_berat, 4), "\n")
cat("Kesimpulan     :", interpret_skewness(skew_berat), "\n\n")


# --- TINGGI BADAN ---
skew_tinggi <- skew_manual(data$Tinggi.Badan..)

cat("--- ANALISIS TINGGI BADAN ---\n")
cat("Nilai Skewness :", round(skew_tinggi, 4), "\n")
cat("Kesimpulan     :", interpret_skewness(skew_tinggi), "\n")



```

